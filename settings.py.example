import os
import json
import copy


BASE_DIR = './'
RAM_DISK_DIR = '/mnt/ramdisk'  # Example for Ubuntu
# RAM_DISK_DIR = 'R:\\'  # Example for Windows
USE_RAM_DISK = False

if USE_RAM_DISK:
    BASE_DIR = RAM_DISK_DIR

CSD_DIRECTORY = os.path.join(BASE_DIR, 'csd')
INPUT_DIRECTORY = os.path.join(BASE_DIR, 'input')
OUTPUT_DIRECTORY = os.path.join(BASE_DIR, 'output')
PROJECT_DATA_DIRECTORY = os.path.join(BASE_DIR, 'projects')
STATS_DATA_DIRECTORY = os.path.join(BASE_DIR, 'stats')
INDIVIDUAL_DATA_DIRECTORY = os.path.join(BASE_DIR, 'individuals')
EFFECT_DIRECTORY = os.path.join(BASE_DIR, 'effects')
TEMP_DIRECTORY = os.path.join(BASE_DIR, 'tmp')
TEST_AUDIO_DIRECTORY = 'test_audio'

CURRENT_PROJECT_FILE = 'test.json'
PRNG_SEED = 2

USE_GZIP = False
if USE_GZIP:
    import gzip
    FILE_HANDLER = gzip.GzipFile
    DATA_FILE_EXTENSION = '.json.gz'
else:
    FILE_HANDLER = open
    DATA_FILE_EXTENSION = '.json'

VERBOSE = False  # Set this to True for debugging purposes

"""Sample rate. CD quality"""
SAMPLE_RATE = 44100

"""The number of samples between two consecutive analysis. AKA ksmps in csound terms."""
AUBIO_HOP_SIZE = 256

"""The number of samples in window used for spectral and temporal computations"""
AUBIO_BUFFER_SIZE = AUBIO_HOP_SIZE * 2

"""ksmps (number of samples per k) for csound"""
CSOUND_KSMPS = AUBIO_HOP_SIZE

WHITELISTED_SOUND_FILE_EXTENSIONS = ['wav']

with FILE_HANDLER('experiment_settings.json') as data_file:
    experiment_settings = json.load(data_file)
    SIMILARITY_CHANNELS = experiment_settings['similarity_channels']
    NEURAL_INPUT_CHANNELS = experiment_settings['neural_input_channels']
    ANALYZE_CHANNELS = copy.deepcopy(NEURAL_INPUT_CHANNELS)
    for channel in SIMILARITY_CHANNELS:
        if channel not in ANALYZE_CHANNELS:
            ANALYZE_CHANNELS.append(channel)
